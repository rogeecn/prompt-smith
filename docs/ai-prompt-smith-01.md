这份文档是基于之前所有对话内容的**产品需求文档 (PRD)** 汇总。它剥离了技术实现细节，完全聚焦于**业务逻辑、用户体验 (UX)** 和 **功能规范**。

---

# 产品需求文档 (PRD) - 智能提示词构建工作台 (Prompt Smith)

| 文档版本 | V1.0 |
| :--- | :--- |
| **文档类型** | 核心功能规格说明书 |
| **核心目标** | 构建一个基于思维链 (CoT) 和多维评估的 AI 提示词生产力工具，支持全生命周期管理（生成、测试、迭代、存储）。 |

---

## 1. 产品概述 (Product Overview)

本产品旨在解决用户“无法精准描述需求”以及“提示词编写质量参差不齐”的痛点。
不同于传统的“填空式”生成器，本产品扮演“**AI 咨询顾问**”的角色。通过结构化的多轮问答引导用户思考，利用后台的**竞争性生成与评分机制**产出高质量 Prompt，并提供**即时测试**与**版本管理**的闭环体验。

---

## 2. 核心用户流程 (User Journey)

1.  **场景接入**：选择从零开始、优化旧词或基于文档创建。
2.  **模型锚定**：选择目标模型（如 ChatGPT, Claude, Midjourney）。
3.  **结构化引导**：通过思维导图形式完成多轮问答，明确需求边界。
4.  **炼丹生成**：后台并发生成多个方案 -> 评分 -> 融合 -> 产出。
5.  **评估与微调**：查看评分雷达图，通过滑块或对话进行微调。
6.  **沙箱验证**：在内置聊天窗口直接测试 Prompt 效果。
7.  **资产沉淀**：保存版本快照，支持回滚、分支管理和导出。

---

## 3. 功能模块详解

### 3.1 模块 A: 初始化与场景选择 (Initialization)

**功能描述**：用户进入工作台的第一步，决定后续的引导策略。

*   **A1. 目标模型选择器 (Target Model Switcher)**
    *   **功能**：用户需选择 Prompt 将运行的目标平台（如 GPT-4, Claude 3, Gemini, Midjourney）。
    *   **逻辑**：此选项将作为全局参数，影响后台 Meta-Prompt 的格式约束（例如：选 Claude 时强制使用 XML 标签）。
*   **A2. 三种进入模式**
    *   **向导模式 (Wizard Mode)**：默认模式。从零开始，通过系统预设的思维导图问题树进行引导。
    *   **优化模式 (Optimization Mode)**：用户粘贴一段现有的（可能效果不好的）Prompt。系统先进行“体检”，列出缺陷，再进入针对性问答。
    *   **知识库模式 (RAG Mode)**：用户上传文档 (PDF/TXT) 或 URL。系统自动提取文档中的背景和约束，跳过基础问答，直接进入高阶配置。

### 3.2 模块 B: 交互式引导系统 (Interactive Q&A)

**功能描述**：前端可视化的思维导图问答界面，用于收集用户意图。

*   **B1. 动态问题树**：基于用户的上一步回答，动态生成下一步提问（非固定死板的表单）。
*   **B2. 实时保存 (Auto-Save)**：用户每回答一个节点，系统静默保存到“草稿箱”，防止意外关闭导致数据丢失。

### 3.3 模块 C: 核心生成引擎 (The "Alchemy" Engine)

**功能描述**：这是产品的核心大脑。用户点击“生成”后，后台执行的黑盒逻辑。

*   **C1. 多维竞优生成 (Competitive Generation)**
    *   系统需并行生成 3 个变体方案：
        *   *方案 A (结构化)*：重逻辑、Markdown、XML。
        *   *方案 B (角色化)*：重沉浸感、语气、心理描写。
        *   *方案 C (推理型)*：重思维链 (CoT)、Step-by-Step。
*   **C2. 批判性评分 (Critical Evaluation)**
    *   系统扮演“面试官”，对 A/B/C 从“清晰度、鲁棒性、对齐度”三个维度打分（0-10分）。
*   **C3. 融合进化 (Synthesis)**
    *   提取三个方案的优点，合成“最终 Prompt”。
    *   **自我修正机制**：如果最终评分低于 90 分，系统需在后台自动进行一轮自我迭代，无需用户干预。
*   **C4. 输出规范强制 (Spec List)**
    *   生成的 Prompt 必须包含标准板块：`Role`, `Context`, `Constraints`, `Workflow`, `Examples`。
    *   **变量注入**：自动识别用户需填写的动态内容，用 `{{variable}}` 标注。
    *   **防御性指令**：必须包含负向约束（“不要做什么”）和思维链激活指令（“在回答前先在 <thinking> 中分析”）。

### 3.4 模块 D: 结果展示与微调 (Result & Refinement)

**功能描述**：展示生成结果，并赋予用户最后修改的权利。

*   **D1. 评分可视化**
    *   展示雷达图 (Radar Chart)，显示最终 Prompt 在逻辑性、创造性、安全性上的得分。
    *   *UI 动效*：展示三个方案汇聚融合成一个的过程，增加专业感。
*   **D2. 元参数滑块 (Meta-Tuner)**
    *   提供滑块供用户快速重绘，无需更改问答历史：
        *   `创造性 (Temperature)`：严谨 <-> 发散
        *   `复杂度 (Complexity)`：精简指令 <-> 详细思维链
*   **D3. 对话式修补 (Conversational Refinement)**
    *   提供一个文本框：“对结果不满意？”
    *   用户可输入自然语言（例如：“语气再俏皮一点”、“输出格式改为 JSON”）。
    *   系统基于当前结果进行增量修改，而非重置。

### 3.5 模块 E: 验证沙箱 (Validation Sandbox)

**功能描述**：解决“复制粘贴去测试”的繁琐体验。

*   **E1. 内置聊天窗口**
    *   在结果页集成 Chat 界面，自动加载刚刚生成的 System Prompt。
    *   用户输入测试用例，即时查看 AI 回复效果。
*   **E2. 效果回测 (Feedback Loop)**
    *   用户可对测试回复进行“点赞/点踩”。
    *   数据沉淀：此数据将用于标记该版本是否为“黄金样本 (Golden Sample)”。

### 3.6 模块 F: 资产与版本管理 (Asset Management)

**功能描述**：基于数据库的全功能版本控制系统（类 Git 体验）。

*   **F1. 项目管理 (Project)**
    *   一个独立的 Prompt 需求定义为一个 Project。
*   **F2. 版本时间轴 (Timeline)**
    *   记录每一次生成的快照 (Snapshot)。
    *   **智能摘要**：时间轴上显示 AI 自动生成的修改日志 (Change Log)，例如 `v3 - 调整受众为小学生`。
*   **F3. 差异对比 (Diff View)**
    *   双栏视图对比两个版本的 Prompt。
    *   高亮显示新增/删除的指令，并标注修改原因。
*   **F4. 分支管理 (Branching)**
    *   支持从历史版本创建新分支（例如从 v2 分叉出 v2-debug），避免覆盖主线。
*   **F5. 导出与分享**
    *   支持导出：PNG (思维导图图片)、JSON (完整配置)、Markdown (提示词文本)。
    *   URL 分享：生成只读链接，通过链接查看思维导图和结果。

---

## 4. 数据结构概要 (Data Entities)

*仅作为逻辑参考，非数据库表设计*

*   **Project**: ID, Name, Created_Time, Owner.
*   **Snapshot (Version)**:
    *   `Input_History`: 完整的问答对数据（用于还原思维导图）。
    *   `Generated_Prompt`: 最终生成的文本。
    *   `Meta_Data`: 评分详情、候选方案 A/B/C、使用的模型参数。
    *   `Change_Log`: 版本摘要。
    *   `Parent_ID`: 上一个版本的 ID。
    *   `User_Rating`: 用户对该版本的满意度。

---

## 5. 非功能性需求 (NFR)

1.  **响应速度**：
    *   前端问答交互无延迟。
    *   生成过程（炼丹）可能耗时较长（10-30秒），必须有清晰的进度条或步骤展示（如：“正在进行批判性评分...”），缓解用户焦虑。
2.  **可用性**：
    *   Prompt 结果支持一键复制。
    *   所有生成的 Markdown 语法需在前端正确渲染。
3.  **安全性**：
    *   用户输入的敏感业务数据（如 API Key、内部文档）需加密处理或仅在会话内存中暂存（视部署方式而定）。

---

## 6. 成功指标 (Success Metrics)

1.  **一次通过率**：用户生成 Prompt 后，直接复制使用未进行微调的比例。
2.  **沙箱使用率**：用户生成后在内置沙箱进行测试的比例（验证闭环体验）。
3.  **版本迭代深度**：平均每个项目生成的版本数量（反映用户是否在深度使用优化功能）。